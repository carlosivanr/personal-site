{
  "hash": "27a87766b90218c2b9ba22110ded458c",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Configure SASPy in venv\"\nhtml:\n    toc: true\n\nexecute:\n  eval: false\n\njupyter: py_env\n---\n\n\n\n\n# Configure SASPy\nIntegrating Python and SAS with [SASPy](https://sassoftware.github.io/saspy/index.html), is a great way to take advantage of the data manipulation capabilities of Python and the analytical capabilities of SAS. The following instructions are to configure a locally installed version of SAS with Python (refer to the SASPy documentation for additional options). This combination streamlines the process of preparing and manipulating data with Python, performing statistical procedures with SAS, and preparing reports with Quarto all within one .qmd file.\n\n\n## Install SASPy\n1. Activate the Python virtual environment\n2. Install SASPy\n\n::: {#9b076412 .cell execution_count=1}\n``` {.python .cell-code}\npip install saspy\n```\n:::\n\n\n## Register the virtual environment\nIf the goal is to render Quarto documents that take advantage of SAS and Python, then this is a necessary step to ensure that rendering a Quarto document will load the proper virtual environment. In order for Quarto to load a virtual environment, it must be registered. In a PowerShell terminal prompt use the following command to see the available registered evironments.\n\n::: {#8e100d63 .cell execution_count=2}\n``` {.python .cell-code}\njupyter kernelspec list\n```\n:::\n\n\nA list of \"Available kernels:\" should appear. If the virtual environment is not listed, then register it with the following command.\n\n::: {#7c945ddf .cell execution_count=3}\n``` {.python .cell-code}\npython -m ipykernel install --user --name=[venv] --display-name=[\"venv\"]\n```\n:::\n\n\nIf the environment is already listed, then proceed to the next step.\n\n## Configure SASPy\n\n1. Start a Python console or continue in the activated Python environment in PowerShell.\n2. Create a personal template cfg file. This creates a file that will be modified and used to configure SASPy. When executing the autocft.main() command, the path of the personal template file will be listed upon execution.\n# need to be modified.\n\n::: {#c778cee4 .cell execution_count=4}\n``` {.python .cell-code}\n# Load the autocfg function from the saspy module\nfrom saspy import autocfg\n\n# Create a template personal cfg file that is used to configure SAS sessions\nautocfg.main() \n```\n:::\n\n\n3. Navigate to the path of the displayed directory\n4. Open the sascfg_personal.py file\n5. Modify the file to set the path of the Java run time executable\n    * Install [Java SE Runtime Environment](https://www.java.com/en/download/manual.jsp) if needed\n6. Save and close the file\n\n::: {#532ad0a3 .cell execution_count=5}\n``` {.python .cell-code}\nautogen_winlocal = {\n\t\"java\"      : \"C:\\\\Program Files (x86)\\\\Java\\\\jre1.8.0_451\\\\bin\\\\java.exe\",\n\t\"encoding\"  : \"windows-1252\"}\n```\n:::\n\n\n## Check that SASPy can start a session\n\n::: {#5c340989 .cell execution_count=6}\n``` {.python .cell-code}\nimport saspy\n\nsas = saspy.SASsession(cfgname = 'autogen_winlocal')\n```\n:::\n\n\n## Configure the yaml header of Quarto document\nOnce SASPy is configured, the Quarto document can be set to use a specific python environment. Simpy modify the yaml header of the quarto document to the name of the desired virtual environment without the square brackets.\n\n::: {#f657c28e .cell execution_count=7}\n``` {.python .cell-code}\n---\njupyter: [venv]\n---\n```\n:::\n\n\n",
    "supporting": [
      "configure_saspy_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}