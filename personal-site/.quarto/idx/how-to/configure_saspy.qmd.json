{"title":"Configure SASPy in venv","markdown":{"yaml":{"title":"Configure SASPy in venv","html":{"toc":true},"execute":{"eval":false},"jupyter":"py_env"},"headingText":"Configure SASPy","containsRefs":false,"markdown":"\n\nIntegrating Python and SAS with [SASPy](https://sassoftware.github.io/saspy/index.html), is a great way to take advantage of the data manipulation capabilities of Python and the analytical capabilities of SAS. The following instructions are to configure a locally installed version of SAS with Python (refer to the SASPy documentation for additional options). This combination streamlines the process of preparing and manipulating data with Python, performing statistical procedures with SAS, and preparing reports with Quarto all within one .qmd file.\n\n\n## Install SASPy\n1. Activate the Python virtual environment\n2. Install SASPy\n```{python}\npip install saspy\n```\n\n## Register the virtual environment\nIf the goal is to render Quarto documents that take advantage of SAS and Python, then this is a necessary step to ensure that rendering a Quarto document will load the proper virtual environment. In order for Quarto to load a virtual environment, it must be registered. In a PowerShell terminal prompt use the following command to see the available registered evironments.\n```{python}\njupyter kernelspec list\n```\n\nA list of \"Available kernels:\" should appear. If the virtual environment is not listed, then register it with the following command.\n```{python}\npython -m ipykernel install --user --name=[venv] --display-name=[\"venv\"]\n```\n\nIf the environment is already listed, then proceed to the next step.\n\n## Configure SASPy\n\n1. Start a Python console or continue in the activated Python environment in PowerShell.\n2. Create a personal template cfg file. This creates a file that will be modified and used to configure SASPy. When executing the autocft.main() command, the path of the personal template file will be displayed upon execution. Make not of the path as this file will need to be modified.\n\n```{python}\n# Load the autocfg function from the saspy module\nfrom saspy import autocfg\n\n# Create a template personal cfg file that is used to configure SAS sessions\nautocfg.main() \n```\n\n3. Navigate to the path of the displayed directory\n4. Open the sascfg_personal.py file\n5. Modify the file to set the path of the Java run time executable\n    * Install [Java SE Runtime Environment](https://www.java.com/en/download/manual.jsp) if needed\n6. Save and close the file\n\n```{python}\nautogen_winlocal = {\n\t\"java\"      : \"C:\\\\Program Files (x86)\\\\Java\\\\jre1.8.0_451\\\\bin\\\\java.exe\",\n\t\"encoding\"  : \"windows-1252\"}\n```\n\n\n## Check that SASPy can start a session\n```{python}\nimport saspy\n\nsas = saspy.SASsession(cfgname = 'autogen_winlocal')\n```\n\n\n## Configure the yaml header of Quarto document\nOnce SASPy is configured, the Quarto document can be set to use a specific python environment. Simpy modify the yaml header of the quarto document to the name of the desired virtual environment without the square brackets.\n\n```{python}\n---\njupyter: [venv]\n---\n\n```\n","srcMarkdownNoYaml":"\n\n# Configure SASPy\nIntegrating Python and SAS with [SASPy](https://sassoftware.github.io/saspy/index.html), is a great way to take advantage of the data manipulation capabilities of Python and the analytical capabilities of SAS. The following instructions are to configure a locally installed version of SAS with Python (refer to the SASPy documentation for additional options). This combination streamlines the process of preparing and manipulating data with Python, performing statistical procedures with SAS, and preparing reports with Quarto all within one .qmd file.\n\n\n## Install SASPy\n1. Activate the Python virtual environment\n2. Install SASPy\n```{python}\npip install saspy\n```\n\n## Register the virtual environment\nIf the goal is to render Quarto documents that take advantage of SAS and Python, then this is a necessary step to ensure that rendering a Quarto document will load the proper virtual environment. In order for Quarto to load a virtual environment, it must be registered. In a PowerShell terminal prompt use the following command to see the available registered evironments.\n```{python}\njupyter kernelspec list\n```\n\nA list of \"Available kernels:\" should appear. If the virtual environment is not listed, then register it with the following command.\n```{python}\npython -m ipykernel install --user --name=[venv] --display-name=[\"venv\"]\n```\n\nIf the environment is already listed, then proceed to the next step.\n\n## Configure SASPy\n\n1. Start a Python console or continue in the activated Python environment in PowerShell.\n2. Create a personal template cfg file. This creates a file that will be modified and used to configure SASPy. When executing the autocft.main() command, the path of the personal template file will be displayed upon execution. Make not of the path as this file will need to be modified.\n\n```{python}\n# Load the autocfg function from the saspy module\nfrom saspy import autocfg\n\n# Create a template personal cfg file that is used to configure SAS sessions\nautocfg.main() \n```\n\n3. Navigate to the path of the displayed directory\n4. Open the sascfg_personal.py file\n5. Modify the file to set the path of the Java run time executable\n    * Install [Java SE Runtime Environment](https://www.java.com/en/download/manual.jsp) if needed\n6. Save and close the file\n\n```{python}\nautogen_winlocal = {\n\t\"java\"      : \"C:\\\\Program Files (x86)\\\\Java\\\\jre1.8.0_451\\\\bin\\\\java.exe\",\n\t\"encoding\"  : \"windows-1252\"}\n```\n\n\n## Check that SASPy can start a session\n```{python}\nimport saspy\n\nsas = saspy.SASsession(cfgname = 'autogen_winlocal')\n```\n\n\n## Configure the yaml header of Quarto document\nOnce SASPy is configured, the Quarto document can be set to use a specific python environment. Simpy modify the yaml header of the quarto document to the name of the desired virtual environment without the square brackets.\n\n```{python}\n---\njupyter: [venv]\n---\n\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"configure_saspy.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.36","theme":"cosmo","title":"Configure SASPy in venv","html":{"toc":true},"jupyter":"py_env"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}